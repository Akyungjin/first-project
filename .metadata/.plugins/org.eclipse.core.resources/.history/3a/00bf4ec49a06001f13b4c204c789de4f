package com.kh.demo.controller;


import java.net.HttpURLConnection;
import java.net.URL;
import java.net.URLEncoder;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;

@Controller
@RequestMapping("/api/*")
public class APIController {
		final static String servicekey = "AFZkEtgk0xRGGmfuchIZQ6ujW2A3p6rD8h0abJ44uyEhRh80fQYfdGWzZO4lT9o%2BGQP0xyX992pmnFg8RVTDxw%3D%3D";
		@GetMapping("get")
		public void replace() {}
		
		@PostMapping("get")
		public String getData(String sidoName)throws Exception {
			//공공데이터포탈과 통신
			String url = "http://apis.data.go.kr/B552584/ArpltnInforInqireSvc/getCtprvnRltmMesureDnsty?servicekey="+servicekey;
			url += "&returnType=json";
			url += "&sidoName="+URLEncoder.encode(sidoName,"UTF-8");
			url += "&numOfRows="+10000;
			
			//단순한 문자열로 정의한 url 변수를 자바에서 네트워킹 때 활용할 수 있는 객체로 변환
			URL requestURL = new URL(url);
			//목적지로 향하는 다리 건설
			HttpURLConnection conn = (HttpURLConnection)requestURL.openConnection();
			
			conn.setRequestMethod("GET");
		}
}
